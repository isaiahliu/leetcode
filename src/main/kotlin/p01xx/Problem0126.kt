package p01xx

import kotlin.system.measureTimeMillis

fun main() {
    class Solution {
        fun findLadders(beginWord: String, endWord: String, wordList: List<String>): List<List<String>> {
            fun String.similar(target: String): Boolean {
                return this.filterIndexed { index, c -> c != target[index] }.length == 1
            }

            val allWords = wordList.toMutableList()

            val stepMap = hashMapOf(0 to listOf(beginWord))
            val steps = arrayListOf(beginWord)
            var step = 0
            while (true) {
                steps.toList().also { steps.clear() }.forEach { task ->
                    allWords.filter { it.similar(task) }.forEach {
                        steps.add(it)
                        allWords.remove(it)
                    }
                }

                if (steps.isEmpty()) {
                    return emptyList()
                }

                stepMap[++step] = steps.toList()

                if (endWord in steps) {
                    break
                }
            }

            val result = arrayListOf<List<String>>()

            val tasks = arrayListOf(listOf(endWord))

            while (result.isEmpty()) {
                val availableWords = stepMap[--step].orEmpty()
                tasks.toList().also { tasks.clear() }.forEach { route ->
                    val word = route[0]
                    availableWords.filter { it.similar(word) }.forEach {
                        if (it == beginWord) {
                            result.add(listOf(it) + route)
                        } else {
                            tasks.add(listOf(it) + route)
                        }
                    }
                }
            }

            return result
        }
    }

    measureTimeMillis {
        Solution().findLadders(
            "aaaaa", "ggggg", listOf(
                "aaaaa",
                "caaaa",
                "cbaaa",
                "daaaa",
                "dbaaa",
                "eaaaa",
                "ebaaa",
                "faaaa",
                "fbaaa",
                "gaaaa",
                "gbaaa",
                "haaaa",
                "hbaaa",
                "iaaaa",
                "ibaaa",
                "jaaaa",
                "jbaaa",
                "kaaaa",
                "kbaaa",
                "laaaa",
                "lbaaa",
                "maaaa",
                "mbaaa",
                "naaaa",
                "nbaaa",
                "oaaaa",
                "obaaa",
                "paaaa",
                "pbaaa",
                "bbaaa",
                "bbcaa",
                "bbcba",
                "bbdaa",
                "bbdba",
                "bbeaa",
                "bbeba",
                "bbfaa",
                "bbfba",
                "bbgaa",
                "bbgba",
                "bbhaa",
                "bbhba",
                "bbiaa",
                "bbiba",
                "bbjaa",
                "bbjba",
                "bbkaa",
                "bbkba",
                "bblaa",
                "bblba",
                "bbmaa",
                "bbmba",
                "bbnaa",
                "bbnba",
                "bboaa",
                "bboba",
                "bbpaa",
                "bbpba",
                "bbbba",
                "abbba",
                "acbba",
                "dbbba",
                "dcbba",
                "ebbba",
                "ecbba",
                "fbbba",
                "fcbba",
                "gbbba",
                "gcbba",
                "hbbba",
                "hcbba",
                "ibbba",
                "icbba",
                "jbbba",
                "jcbba",
                "kbbba",
                "kcbba",
                "lbbba",
                "lcbba",
                "mbbba",
                "mcbba",
                "nbbba",
                "ncbba",
                "obbba",
                "ocbba",
                "pbbba",
                "pcbba",
                "ccbba",
                "ccaba",
                "ccaca",
                "ccdba",
                "ccdca",
                "cceba",
                "cceca",
                "ccfba",
                "ccfca",
                "ccgba",
                "ccgca",
                "cchba",
                "cchca",
                "cciba",
                "ccica",
                "ccjba",
                "ccjca",
                "cckba",
                "cckca",
                "cclba",
                "cclca",
                "ccmba",
                "ccmca",
                "ccnba",
                "ccnca",
                "ccoba",
                "ccoca",
                "ccpba",
                "ccpca",
                "cccca",
                "accca",
                "adcca",
                "bccca",
                "bdcca",
                "eccca",
                "edcca",
                "fccca",
                "fdcca",
                "gccca",
                "gdcca",
                "hccca",
                "hdcca",
                "iccca",
                "idcca",
                "jccca",
                "jdcca",
                "kccca",
                "kdcca",
                "lccca",
                "ldcca",
                "mccca",
                "mdcca",
                "nccca",
                "ndcca",
                "occca",
                "odcca",
                "pccca",
                "pdcca",
                "ddcca",
                "ddaca",
                "ddada",
                "ddbca",
                "ddbda",
                "ddeca",
                "ddeda",
                "ddfca",
                "ddfda",
                "ddgca",
                "ddgda",
                "ddhca",
                "ddhda",
                "ddica",
                "ddida",
                "ddjca",
                "ddjda",
                "ddkca",
                "ddkda",
                "ddlca",
                "ddlda",
                "ddmca",
                "ddmda",
                "ddnca",
                "ddnda",
                "ddoca",
                "ddoda",
                "ddpca",
                "ddpda",
                "dddda",
                "addda",
                "aedda",
                "bddda",
                "bedda",
                "cddda",
                "cedda",
                "fddda",
                "fedda",
                "gddda",
                "gedda",
                "hddda",
                "hedda",
                "iddda",
                "iedda",
                "jddda",
                "jedda",
                "kddda",
                "kedda",
                "lddda",
                "ledda",
                "mddda",
                "medda",
                "nddda",
                "nedda",
                "oddda",
                "oedda",
                "pddda",
                "pedda",
                "eedda",
                "eeada",
                "eeaea",
                "eebda",
                "eebea",
                "eecda",
                "eecea",
                "eefda",
                "eefea",
                "eegda",
                "eegea",
                "eehda",
                "eehea",
                "eeida",
                "eeiea",
                "eejda",
                "eejea",
                "eekda",
                "eekea",
                "eelda",
                "eelea",
                "eemda",
                "eemea",
                "eenda",
                "eenea",
                "eeoda",
                "eeoea",
                "eepda",
                "eepea",
                "eeeea",
                "ggggg",
                "agggg",
                "ahggg",
                "bgggg",
                "bhggg",
                "cgggg",
                "chggg",
                "dgggg",
                "dhggg",
                "egggg",
                "ehggg",
                "fgggg",
                "fhggg",
                "igggg",
                "ihggg",
                "jgggg",
                "jhggg",
                "kgggg",
                "khggg",
                "lgggg",
                "lhggg",
                "mgggg",
                "mhggg",
                "ngggg",
                "nhggg",
                "ogggg",
                "ohggg",
                "pgggg",
                "phggg",
                "hhggg",
                "hhagg",
                "hhahg",
                "hhbgg",
                "hhbhg",
                "hhcgg",
                "hhchg",
                "hhdgg",
                "hhdhg",
                "hhegg",
                "hhehg",
                "hhfgg",
                "hhfhg",
                "hhigg",
                "hhihg",
                "hhjgg",
                "hhjhg",
                "hhkgg",
                "hhkhg",
                "hhlgg",
                "hhlhg",
                "hhmgg",
                "hhmhg",
                "hhngg",
                "hhnhg",
                "hhogg",
                "hhohg",
                "hhpgg",
                "hhphg",
                "hhhhg",
                "ahhhg",
                "aihhg",
                "bhhhg",
                "bihhg",
                "chhhg",
                "cihhg",
                "dhhhg",
                "dihhg",
                "ehhhg",
                "eihhg",
                "fhhhg",
                "fihhg",
                "ghhhg",
                "gihhg",
                "jhhhg",
                "jihhg",
                "khhhg",
                "kihhg",
                "lhhhg",
                "lihhg",
                "mhhhg",
                "mihhg",
                "nhhhg",
                "nihhg",
                "ohhhg",
                "oihhg",
                "phhhg",
                "pihhg",
                "iihhg",
                "iiahg",
                "iiaig",
                "iibhg",
                "iibig",
                "iichg",
                "iicig",
                "iidhg",
                "iidig",
                "iiehg",
                "iieig",
                "iifhg",
                "iifig",
                "iighg",
                "iigig",
                "iijhg",
                "iijig",
                "iikhg",
                "iikig",
                "iilhg",
                "iilig",
                "iimhg",
                "iimig",
                "iinhg",
                "iinig",
                "iiohg",
                "iioig",
                "iiphg",
                "iipig",
                "iiiig",
                "aiiig",
                "ajiig",
                "biiig",
                "bjiig",
                "ciiig",
                "cjiig",
                "diiig",
                "djiig",
                "eiiig",
                "ejiig",
                "fiiig",
                "fjiig",
                "giiig",
                "gjiig",
                "hiiig",
                "hjiig",
                "kiiig",
                "kjiig",
                "liiig",
                "ljiig",
                "miiig",
                "mjiig",
                "niiig",
                "njiig",
                "oiiig",
                "ojiig",
                "piiig",
                "pjiig",
                "jjiig",
                "jjaig",
                "jjajg",
                "jjbig",
                "jjbjg",
                "jjcig",
                "jjcjg",
                "jjdig",
                "jjdjg",
                "jjeig",
                "jjejg",
                "jjfig",
                "jjfjg",
                "jjgig",
                "jjgjg",
                "jjhig",
                "jjhjg",
                "jjkig",
                "jjkjg",
                "jjlig",
                "jjljg",
                "jjmig",
                "jjmjg",
                "jjnig",
                "jjnjg",
                "jjoig",
                "jjojg",
                "jjpig",
                "jjpjg",
                "jjjjg",
                "ajjjg",
                "akjjg",
                "bjjjg",
                "bkjjg",
                "cjjjg",
                "ckjjg",
                "djjjg",
                "dkjjg",
                "ejjjg",
                "ekjjg",
                "fjjjg",
                "fkjjg",
                "gjjjg",
                "gkjjg",
                "hjjjg",
                "hkjjg",
                "ijjjg",
                "ikjjg",
                "ljjjg",
                "lkjjg",
                "mjjjg",
                "mkjjg",
                "njjjg",
                "nkjjg",
                "ojjjg",
                "okjjg",
                "pjjjg",
                "pkjjg",
                "kkjjg",
                "kkajg",
                "kkakg",
                "kkbjg",
                "kkbkg",
                "kkcjg",
                "kkckg",
                "kkdjg",
                "kkdkg",
                "kkejg",
                "kkekg",
                "kkfjg",
                "kkfkg",
                "kkgjg",
                "kkgkg",
                "kkhjg",
                "kkhkg",
                "kkijg",
                "kkikg",
                "kkljg",
                "kklkg",
                "kkmjg",
                "kkmkg",
                "kknjg",
                "kknkg",
                "kkojg",
                "kkokg",
                "kkpjg",
                "kkpkg",
                "kkkkg",
                "ggggx",
                "gggxx",
                "ggxxx",
                "gxxxx",
                "xxxxx",
                "xxxxy",
                "xxxyy",
                "xxyyy",
                "xyyyy",
                "yyyyy",
                "yyyyw",
                "yyyww",
                "yywww",
                "ywwww",
                "wwwww",
                "wwvww",
                "wvvww",
                "vvvww",
                "vvvwz",
                "avvwz",
                "aavwz",
                "aaawz",
                "aaaaz"
            )
        ).also {
            println(it)
        }
    }.also { println("Time cost: ${it}ms") }
}

