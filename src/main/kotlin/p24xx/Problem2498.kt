package p24xx

import util.expect
import java.util.*

fun main() {
    class Solution {
        fun maxJump(stones: IntArray): Int {
            val target = stones.last()
            var min = 1
            var max = stones.last()
            var result = 0
            while (min <= max) {
                val mid = min + (max - min) / 2

                val stoneSet = TreeSet<Int>()
                stones.forEach {
                    stoneSet.add(it)
                }

                var success = false
                var current = 0
                while (current < target) {
                    stoneSet.floor(current + mid)?.takeIf { it > current }?.also {
                        stoneSet.remove(it)
                        current = it
                    } ?: break
                }

                if (current == target) {
                    while (current > 0) {
                        stoneSet.ceiling(current - mid)?.takeIf { it < current }?.also {
                            stoneSet.remove(it)
                            current = it
                        } ?: break
                    }

                    success = current == 0
                }
                if (success) {
                    result = mid
                    max = mid - 1
                } else {
                    min = mid + 1
                }
            }

            return result
        }
    }

    expect {
        Solution().maxJump(
            intArrayOf(
                0,
                469,
                845,
                1221,
                1356,
                2570,
                2896,
                2934,
                3257,
                3512,
                3833,
                3912,
                4579,
                5063,
                5363,
                5447,
                5662,
                6188,
                6468,
                7001,
                7015,
                7145,
                7846,
                7956,
                10769,
                11182,
                11644,
                13794,
                15693,
                16695,
                16746,
                17917,
                18302,
                18506,
                18859,
                19014,
                20118,
                22064,
                22616,
                23528,
                24042,
                24720,
                24806,
                25069,
                26166,
                27233,
                28239,
                28340,
                28419,
                28835,
                29029,
                29414,
                29701,
                29926,
                29997,
                30502,
                30737,
                31143,
                31922,
                32474,
                33007,
                33017,
                33023,
                33701,
                34216,
                34242,
                34441,
                34611,
                34653,
                34853,
                35263,
                36765,
                37401,
                37819,
                39149,
                39341,
                39468,
                39724,
                40639,
                40932,
                41189,
                41770,
                41782,
                41956,
                44561,
                44809,
                45731,
                45753,
                45817,
                47021,
                47332,
                47444,
                47720,
                48547,
                48767,
                49048,
                49507,
                50360,
                51281,
                51380,
                51650,
                52288,
                52628,
                52770,
                53107,
                54252,
                54485,
                54708,
                55269,
                55407,
                55938,
                57004,
                57168,
                58145,
                58215,
                59290,
                61049,
                61566,
                61991,
                62134,
                62925,
                63246,
                63579,
                64086,
                64287,
                64347,
                64391,
                65009,
                65242,
                66094,
                66137,
                66175,
                66455,
                66702,
                67417,
                67457,
                69622,
                69870,
                70134,
                70528,
                70975,
                71330,
                71479,
                72780,
                72865,
                72870,
                73440,
                74730,
                74956,
                75007,
                75428,
                75468,
                75655,
                76698,
                77426,
                78136,
                78276,
                78914,
                78994,
                79389,
                79532,
                79591,
                80163,
                80374,
                80717,
                80726,
                81572,
                82360,
                83074,
                83592,
                83792,
                83809,
                83993,
                84372,
                84429,
                85739,
                86470,
                86660,
                86837,
                87598,
                87905,
                88356,
                88781,
                89795,
                90255,
                90638,
                91024,
                91071,
                92315,
                92381,
                93214,
                93776,
                93994,
                94540,
                95084,
                97217,
                98198,
                98207,
                98322,
                98427,
                99383,
                99794,
                100174,
                100955,
                101492,
                101653,
                101918,
                102557,
                102829,
                103024,
                103491,
                103952,
                104343,
                104360,
                104629,
                106581,
                107540,
                107989,
                108043,
                108162,
                109475,
                109824,
                110062,
                110123,
                110503,
                111380,
                111430,
                111909,
                112102,
                112493,
                112718,
                112916,
                114514,
                116653,
                116998,
                117049,
                117443,
                117750,
                118150,
                118670,
                118936,
                120069,
                121047,
                122457,
                122955,
                123248,
                123279,
                123406,
                123450,
                123952,
                124250,
                125728,
                126154,
                126373,
                128397,
                129302,
                129684,
                129851,
                130569,
                131020,
                131025,
                131187,
                131957,
                132131,
                132647,
                133511,
                133519,
                133522,
                133529,
                133754,
                134222,
                135189,
                136668,
                136979,
                137821,
                142138,
                143693,
                143779,
                144380,
                144562,
                144664,
                144778,
                145154,
                145411,
                145660,
                146531,
                146795,
                147035,
                147382,
                147802,
                148073,
                149131,
                149174,
                149708,
                149716,
                149884,
                150024,
                150167,
                150501,
                150617,
                151635,
                152812,
                152879,
                153114,
                153995,
                154349,
                154989,
                155260,
                155308,
                155894,
                156751,
                157298,
                158120,
                159772,
                160192,
                160343,
                160972,
                161758,
                162250,
                163267,
                163605,
                163670,
                164107,
                164111,
                164843,
                165947,
                166338,
                166387,
                166457,
                166988,
                167081,
                167456,
                167604,
                168491,
                168662,
                168896,
                169135,
                169173,
                169228,
                169285,
                169314,
                170580,
                170880,
                171063,
                171330,
                171485,
                172765,
                172832,
                174236,
                175726,
                175897,
                177641,
                177706,
                177836,
                178223,
                178319,
                178350,
                178603,
                178928,
                179119,
                179146,
                179469,
                179529,
                179894,
                180071,
                180550,
                181024,
                181359,
                181406,
                181549,
                181805,
                181897,
                182244,
                182817,
                182916,
                184593,
                184860,
                185291,
                186148,
                186776,
                186839,
                186951,
                188266,
                188332,
                188337,
                188603,
                189620,
                190234,
                190863,
                191119,
                191272,
                191607,
                191976,
                192750,
                193348,
                193425,
                194056,
                194168,
                194853,
                195930,
                196320,
                196334,
                196447,
                198213,
                199201,
                199913,
                201319,
                202213,
                203610,
                204665,
                204751,
                205004,
                205121,
                207276,
                207287,
                207638,
                208911,
                210502,
                210549,
                211078,
                211493,
                211683,
                212229,
                212325,
                212425,
                213570,
                213587,
                213942,
                215183,
                215534,
                215719,
                215849,
                215917,
                216859,
                217908,
                218301,
                218543,
                219526,
                219883,
                220538,
                221059,
                222378,
                222583,
                223191,
                223956,
                224122,
                224204,
                224215,
                224346,
                224446,
                225023,
                225470,
                225985,
                226121,
                227891,
                228284,
                228328,
                228358,
                228659,
                229750,
                229824,
                229874,
                230785,
                230963,
                233210,
                233843,
                234023,
                234422,
                234747,
                235673,
                235850,
                235965,
                236266,
                236886,
                237632,
                237796,
                239658,
                240538,
                240627,
                240628,
                240977,
                241003,
                241004,
                241389,
                241846,
                241952,
                242600,
                243731,
                243801,
                244312,
                244812,
                245227,
                246939,
                246965,
                247233,
                247735,
                247886,
                247981,
                248630,
                249148
            )
        )
    }
}